@startuml
start

partition "ユーザー操作フェーズ" {

    :ファイルのリソースを指定;

    :ファイル形式の一覧を取得;
    if ("一覧取得成功？") then (はい)
        :ファイル形式を選択;
    else (いいえ)
        :エラー表示（一覧取得失敗）;
        stop
    endif

    :ローカルサーバーに\nダウンロードジョブを登録;
    if ("ジョブ登録成功？") then (はい)
    else (いいえ)
        :エラー表示（登録失敗）;
        stop
    endif
}

partition "スケジュール実行フェーズ" {

    :ジョブスケジュールを検知;

    :ダウンロードコマンドを実行;
    if ("実行成功？") then (はい)
    else (いいえ)
        :エラーをログに記録;
        stop
    endif

    :ファイルを取得;
    if ("取得成功？") then (はい)
    else (いいえ)
        :再試行またはエラー通知;
        stop
    endif

    :ダウンロード完了通知を送信;
    if ("通知成功？") then (はい)
        :正常終了;
    else (いいえ)
        :通知エラーをログに記録;
        stop
    endif
}

stop
@enduml
